import tensorflow as tf
import numpy as np
from PIL import Image
import matplotlib.pyplot as plt
from tensorflow.keras.preprocessing import image
from tensorflow.keras.applications.imagenet_utils import decode_predictions

# Load the pre-trained model
model = tf.keras.applications.ResNet50(weights='imagenet')

# Load the image
image_path = '/content/data/sportscar.jpeg'
image = Image.open(image_path)

# Preprocess the image
image = image.resize((224, 224))
image = np.array(image)
image = np.expand_dims(image, axis=0)
image = tf.keras.applications.resnet50.preprocess_input(image)

# Predict the class probabilities
predictions = model.predict(image)

# Decode the predictions
decoded_predictions = decode_predictions(predictions, top=5)[0]

# Print the top 5 predictions
for _, name, score in decoded_predictions:
  print(f'{name}: {score:.2f}')

# Display the image
plt.imshow(image[0])
plt.show()
